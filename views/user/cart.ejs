<% layout('./layout/boilerplate') %>

<h2>Cart</h2>

<div class="row"style="padding:50px 0px">
    <% for (let product of products){   %>
      <div class="col-lg-3 mb-3 ">
       <div class="card shadow-lg mx-auto" style="width: 18rem;">
          <img src="<%=product.img%>" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title"><%=product.name%></h5>
            <p class="card-text"><%=product.desc%></p>
            <h3 class="card-text">Price: Rs.<%=product.price%></h3>
            <a href="/products/<%=product.id%>" class="btn btn-primary">Show Product</a>
            <br><br>
            <form action="/products/cart/<%=product.id%>?_method=delete" method="post"><button class="btn btn-danger">Remove from Cart</button></form>
          </div>
        </div> 
      </div>
        <%}%>
  </div>
  <% let qty=user.qty%>
  <% let total = 0 %>
  <% for(let i=0;i<products.length;i++){%>
    <h5><%= products[i].name %> </h5>
    <h5>Quantity: <%=qty[i]%> Total: <%= products[i].price*qty[i]%></h5>
    <%total+=products[i].price*qty[i]%>
    <%}%>
    <br>
    <div class="off">
    <label for="offer">Select offer</label>
    <select name="offer" id="offer">
      <option value="0" selected disabled>Select offer</option>
      <%for(let offer of offers){%>
        <option value="<%=offer.percent%>"><%=offer.desc%> <%=offer.percent%>%</option>
      <%}%>
    </select>
  </div>
  <br>
  <div class="points">
    <input type="checkbox" name="reward" id="reward"><label for="reward">Use rewards points</label>
    <p>Available:<%=user.reward%></p>
  </div>
  <br>
  

  <div class="dis">
    <label for="discount">Discount = </label>
    <input type="Number" id="discount" value="0" disabled>
  </div>
<h1>Grand Total= Rs. <%=total %></h1>
<form action="/order/<%=total%>" method="post"><button class="btn btn-success">Place Order</button></form>
<script>
    
</script>